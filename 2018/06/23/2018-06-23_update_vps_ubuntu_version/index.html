<!doctype html><html lang=en><head><title>Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06 :: 不是追风少年</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="What happened? I found my proxy for accessing some websites stopped working today, so I had to change my VPS&amp;rsquo;s IP address. After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.
Emmmm, I noticed 12 packages needed to be updated. Well, I typed sudo apt-get update and got messages like this (I didn&amp;rsquo;t save the error messages then):
404 Not Found [IP: 91."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.formalscience.com/2018/06/23/2018-06-23_update_vps_ubuntu_version/><link rel=stylesheet href=https://blog.formalscience.com/assets/style.css><link rel=stylesheet href=assets/%25!s%28%3cnil%3e%29.css><link rel=apple-touch-icon href=https://blog.formalscience.com/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://blog.formalscience.com/img/favicon/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06"><meta property="og:description" content="What happened? I found my proxy for accessing some websites stopped working today, so I had to change my VPS&amp;rsquo;s IP address. After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.
Emmmm, I noticed 12 packages needed to be updated. Well, I typed sudo apt-get update and got messages like this (I didn&amp;rsquo;t save the error messages then):
404 Not Found [IP: 91."><meta property="og:url" content="https://blog.formalscience.com/2018/06/23/2018-06-23_update_vps_ubuntu_version/"><meta property="og:site_name" content="不是追风少年"><meta property="og:image" content="img/favicon/%!s().png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="技术记录"><meta property="article:section" content="tech-notes"><meta property="article:published_time" content="2018-06-23 00:00:00 +0000 UTC"></head><body><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://blog.formalscience.com/><div class=logo>Terminal</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>Home</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>Home</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://blog.formalscience.com/2018/06/23/2018-06-23_update_vps_ubuntu_version/>Upgrade DigitalOcean&rsquo;s Ubuntu 17.04 to LTS version in 2018-06</a></h1><div class=post-meta><span class=post-date>2018-06-23</span></div><div class=post-content><div><h2 id=what-happened>What happened?<a href=#what-happened class=hanchor arialabel=Anchor>&#8983;</a></h2><p>I found my proxy for accessing some websites stopped working today, so I had to change my VPS&rsquo;s IP address.
After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.</p><p>Emmmm, I noticed 12 packages needed to be updated.
Well, I typed <code>sudo apt-get update</code> and got messages like this (I didn&rsquo;t save the error messages then):</p><pre tabindex=0><code>  404  Not Found [IP: 91.189.91.23 80]
Ign:10 http://us.archive.ubuntu.com/ubuntu zesty-backports InRelease
Err:11 http://us.archive.ubuntu.com/ubuntu zesty Release
  404  Not Found [IP: 91.189.91.26 80]
Err:12 http://us.archive.ubuntu.com/ubuntu zesty-updates Release
  404  Not Found [IP: 91.189.91.26 80]
Err:13 http://us.archive.ubuntu.com/ubuntu zesty-backports Release
  404  Not Found [IP: 91.189.91.26 80]
Reading package lists... Done
E: The repository &#39;http://security.ubuntu.com/ubuntu zesty-security Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty-updates Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty-backports Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
</code></pre><p>Wow, It was the first time I encountered such things.
After some digging, I realized it was because Ubuntu 17.04 (zesty) was not supported any longer.</p><p>According to <a href=https://wiki.ubuntu.com/ZestyZapus/ReleaseNotes>https://wiki.ubuntu.com/ZestyZapus/ReleaseNotes</a></p><blockquote><p>Ubuntu 17.04 will be supported for 9 months until January 2018. If you need Long Term Support, it is recommended you use Ubuntu 16.04 LTS instead.</p></blockquote><p>It means my current release version (Ubuntu 17.04) won&rsquo;t receive any updates in the future.</p><p><img src=https://assets.ubuntu.com/v1/f02f0a4b-r-eol-ubuntu-full-2018-02-28.png alt=release-end-of-life-date></p><h2 id=how-to-upgrade>How to upgrade<a href=#how-to-upgrade class=hanchor arialabel=Anchor>&#8983;</a></h2><p>I was struggled to reveal some steps to upgrade my Ubuntu 17.04 (End-of-Life) to 18.04 (LTS version).</p><p>The official guide to upgrade from an Ubuntu release which reaches its “end of life” is: <a href=https://help.ubuntu.com/community/EOLUpgrades>https://help.ubuntu.com/community/EOLUpgrades</a></p><h3 id=1-update-sourceslist>1. Update sources.list<a href=#1-update-sourceslist class=hanchor arialabel=Anchor>&#8983;</a></h3><p>The path of <em>sources.list</em> is <em>/etc/apt/sources.list</em>.</p><pre tabindex=0><code>## EOL upgrade sources.list
# Required
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME main restricted universe multiverse
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-updates main restricted universe multiverse
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-security main restricted universe multiverse

# Optional
#deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-backports main restricted universe multiverse
</code></pre><p>In my case, <code>CODENAME</code> should be replaced by <code>zesty</code>.</p><h3 id=2-upgrade>2. Upgrade<a href=#2-upgrade class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Try <code>apt-get upgrade</code>, and I got:</p><pre tabindex=0><code>dpkg: dependency problems prevent configuration of ubuntu-standard:
 ubuntu-standard depends on libpam-systemd; however:
  Package libpam-systemd:amd64 is not configured yet.
</code></pre><p>By some method suggested by stackoverflowers, I finally got over it by these commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dpkg --force-all -P libpam-systemd
</span></span><span style=display:flex><span>sudo apt-get -f install libpam-systemd
</span></span></code></pre></div><h3 id=3-dist-upgrade>3. Dist Upgrade<a href=#3-dist-upgrade class=hanchor arialabel=Anchor>&#8983;</a></h3><p>These are some normal steps for an upgrade.</p><pre tabindex=0><code>sudo apt-get dist-upgrade
sudo do-release-upgrade
</code></pre><p>If you&rsquo;re unlucky like me, you will not upgrade to a newer release completely.
You may see:</p><pre tabindex=0><code>Package grub-efi-amd64 is not configured yet.
</code></pre><p>According to <a href=https://askubuntu.com/questions/330531/unable-to-fix-broken-package-system>a question</a> asked by someone, you can try this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dpkg --force-all -P grub-efi-amd64
</span></span><span style=display:flex><span>sudo dpkg --force-all -P grub-efi-amd64-signed
</span></span></code></pre></div><p>Execute <code>sudo apt-get update</code> and <code>sudo apt-get upgrade</code>.</p><h3 id=4-thoughts>4. Thoughts<a href=#4-thoughts class=hanchor arialabel=Anchor>&#8983;</a></h3><p>I first upgraded to Ubuntu 17.10 then Ubuntu 18.04.</p><p>To see if I have done the right things, I check the release version by <code>sudo lsb_release -a</code>:</p><pre tabindex=0><code>Distributor ID:    Ubuntu
Description:       Ubuntu 18.04 LTS
Release:           18.04
Codename:          bionic
</code></pre><p>Is it the DigitalOcean&rsquo;s customized release makes the upgrade so complex for a non-expert programmer or the Ubuntu release itself?</p><p>But apparently, I&rsquo;m not the only one who is confused by the error messages and asks questions on the web. Luckily I&rsquo;ve found helping answers I need.</p><p>The commands with words like <code>force</code> or <code>-f</code> make me feel anxious.</p><blockquote><p>These violent delights have violent ends.
&mdash; by Shakespeare</p></blockquote><p><img src="https://cdn.vox-cdn.com/thumbor/NxFcQHzIb1eqgk5EXafSzFwy2UU=/0x0:5100x3400/920x613/filters:focal(1816x555:2632x1371):format(webp)/cdn.vox-cdn.com/uploads/chorus_image/image/52220535/westworld_dolores.0.jpeg" alt=Dolores></p><p>Anyway, it works.</p></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://blog.formalscience.com/assets/main.js></script>
<script src=https://blog.formalscience.com/assets/prism.js></script></div></body></html>