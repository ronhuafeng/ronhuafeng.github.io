<!doctype html><html lang=zh-cn><head><title>Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06 // 不是追风少年</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.103.1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="bef0rewind"><meta name=description content><link rel=stylesheet href=https://blog.formalscience.com/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06"><meta name=twitter:description content="What happened? I found my proxy for accessing some websites stopped working today, so I had to change my VPS&rsquo;s IP address. After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.
Emmmm, I noticed 12 packages needed to be updated. Well, I typed sudo apt-get update and got messages like this (I didn&rsquo;t save the error messages then):
404 Not Found [IP: 91."><meta property="og:title" content="Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06"><meta property="og:description" content="What happened? I found my proxy for accessing some websites stopped working today, so I had to change my VPS&rsquo;s IP address. After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.
Emmmm, I noticed 12 packages needed to be updated. Well, I typed sudo apt-get update and got messages like this (I didn&rsquo;t save the error messages then):
404 Not Found [IP: 91."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.formalscience.com/2018/06/23/2018-06-23_update_vps_ubuntu_version/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-06-23T00:00:00+00:00"><meta property="article:modified_time" content="2018-06-23T00:00:00+00:00"></head><body><header class=app-header><a href=https://blog.formalscience.com/><img class=app-header-avatar src=/avatar.jpg alt=bef0rewind></a><h1>不是追风少年</h1><nav class=app-header-menu><a class=app-header-menu-item href=/>Home</a>
-
<a class=app-header-menu-item href=/categories/>Categories</a>
-
<a class=app-header-menu-item href=/tags/>Tags</a>
-
<a class=app-header-menu-item href=/about/>About</a></nav><p>当你在追着风，风也在推着你</p><div class=app-header-social><a href=https://github.com/ronhuafeng target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>我的 GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Upgrade DigitalOcean's Ubuntu 17.04 to LTS version in 2018-06</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Jun 23, 2018</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>4 min read</div></div></header><div class=post-content><h2 id=what-happened>What happened?</h2><p>I found my proxy for accessing some websites stopped working today, so I had to change my VPS&rsquo;s IP address.
After some trials, everything seemed OK and I started watching a skiing video made by NorthFace on Youtube.</p><p>Emmmm, I noticed 12 packages needed to be updated.
Well, I typed <code>sudo apt-get update</code> and got messages like this (I didn&rsquo;t save the error messages then):</p><pre tabindex=0><code>  404  Not Found [IP: 91.189.91.23 80]
Ign:10 http://us.archive.ubuntu.com/ubuntu zesty-backports InRelease
Err:11 http://us.archive.ubuntu.com/ubuntu zesty Release
  404  Not Found [IP: 91.189.91.26 80]
Err:12 http://us.archive.ubuntu.com/ubuntu zesty-updates Release
  404  Not Found [IP: 91.189.91.26 80]
Err:13 http://us.archive.ubuntu.com/ubuntu zesty-backports Release
  404  Not Found [IP: 91.189.91.26 80]
Reading package lists... Done
E: The repository &#39;http://security.ubuntu.com/ubuntu zesty-security Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty-updates Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
E: The repository &#39;http://us.archive.ubuntu.com/ubuntu zesty-backports Release&#39; does no longer have a Release file.
N: Updating from such a repository can&#39;t be done securely, and is therefore disabled by default.
N: See apt-secure(8) manpage for repository creation and user configuration details.
</code></pre><p>Wow, It was the first time I encountered such things.
After some digging, I realized it was because Ubuntu 17.04 (zesty) was not supported any longer.</p><p>According to <a href=https://wiki.ubuntu.com/ZestyZapus/ReleaseNotes>https://wiki.ubuntu.com/ZestyZapus/ReleaseNotes</a></p><blockquote><p>Ubuntu 17.04 will be supported for 9 months until January 2018. If you need Long Term Support, it is recommended you use Ubuntu 16.04 LTS instead.</p></blockquote><p>It means my current release version (Ubuntu 17.04) won&rsquo;t receive any updates in the future.</p><p><img src=https://assets.ubuntu.com/v1/f02f0a4b-r-eol-ubuntu-full-2018-02-28.png alt=release-end-of-life-date></p><h2 id=how-to-upgrade>How to upgrade</h2><p>I was struggled to reveal some steps to upgrade my Ubuntu 17.04 (End-of-Life) to 18.04 (LTS version).</p><p>The official guide to upgrade from an Ubuntu release which reaches its “end of life” is: <a href=https://help.ubuntu.com/community/EOLUpgrades>https://help.ubuntu.com/community/EOLUpgrades</a></p><h3 id=1-update-sourceslist>1. Update sources.list</h3><p>The path of <em>sources.list</em> is <em>/etc/apt/sources.list</em>.</p><pre tabindex=0><code>## EOL upgrade sources.list
# Required
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME main restricted universe multiverse
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-updates main restricted universe multiverse
deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-security main restricted universe multiverse

# Optional
#deb http://old-releases.ubuntu.com/ubuntu/ CODENAME-backports main restricted universe multiverse
</code></pre><p>In my case, <code>CODENAME</code> should be replaced by <code>zesty</code>.</p><h3 id=2-upgrade>2. Upgrade</h3><p>Try <code>apt-get upgrade</code>, and I got:</p><pre tabindex=0><code>dpkg: dependency problems prevent configuration of ubuntu-standard:
 ubuntu-standard depends on libpam-systemd; however:
  Package libpam-systemd:amd64 is not configured yet.
</code></pre><p>By some method suggested by stackoverflowers, I finally got over it by these commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dpkg --force-all -P libpam-systemd
</span></span><span style=display:flex><span>sudo apt-get -f install libpam-systemd
</span></span></code></pre></div><h3 id=3-dist-upgrade>3. Dist Upgrade</h3><p>These are some normal steps for an upgrade.</p><pre tabindex=0><code>sudo apt-get dist-upgrade
sudo do-release-upgrade
</code></pre><p>If you&rsquo;re unlucky like me, you will not upgrade to a newer release completely.
You may see:</p><pre tabindex=0><code>Package grub-efi-amd64 is not configured yet.
</code></pre><p>According to <a href=https://askubuntu.com/questions/330531/unable-to-fix-broken-package-system>a question</a> asked by someone, you can try this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dpkg --force-all -P grub-efi-amd64
</span></span><span style=display:flex><span>sudo dpkg --force-all -P grub-efi-amd64-signed
</span></span></code></pre></div><p>Execute <code>sudo apt-get update</code> and <code>sudo apt-get upgrade</code>.</p><h3 id=4-thoughts>4. Thoughts</h3><p>I first upgraded to Ubuntu 17.10 then Ubuntu 18.04.</p><p>To see if I have done the right things, I check the release version by <code>sudo lsb_release -a</code>:</p><pre tabindex=0><code>Distributor ID:    Ubuntu
Description:       Ubuntu 18.04 LTS
Release:           18.04
Codename:          bionic
</code></pre><p>Is it the DigitalOcean&rsquo;s customized release makes the upgrade so complex for a non-expert programmer or the Ubuntu release itself?</p><p>But apparently, I&rsquo;m not the only one who is confused by the error messages and asks questions on the web. Luckily I&rsquo;ve found helping answers I need.</p><p>The commands with words like <code>force</code> or <code>-f</code> make me feel anxious.</p><blockquote><p>These violent delights have violent ends.
&mdash; by Shakespeare</p></blockquote><p><img src="https://cdn.vox-cdn.com/thumbor/NxFcQHzIb1eqgk5EXafSzFwy2UU=/0x0:5100x3400/920x613/filters:focal(1816x555:2632x1371):format(webp)/cdn.vox-cdn.com/uploads/chorus_image/image/52220535/westworld_dolores.0.jpeg" alt=Dolores></p><p>Anyway, it works.</p></div><div class=post-footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//bef0rewind-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></main></body></html>